<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>婚宴座位導航 - 喜帖風格版</title>
<style>
/* === 1. 喜帖風格色系 (Dusty Pink & Forest Green) === */
:root {
    --theme-green: #556B2F;    /* 橄欖綠/森林綠 */
    --theme-pink: #E8ADAA;     /* 莫蘭迪粉 */
    --theme-pink-light: #F9E8E6; 
    --bg-cream: #FFFCF5;       /* 米白紙質感 */
    --text-dark: #4A4A4A;
    --border-gold: #C5A065;
}

body {
    font-family: "Times New Roman", "Noto Serif TC", "Microsoft JhengHei", serif;
    background-color: #e0e0e0; /* 網頁背景深一點，凸顯中間的卡片 */
    margin: 0; padding: 0;
    color: var(--text-dark);
    height: 100vh; 
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden;
}

/* === 2. 喜帖卡片容器 (直式長方形) === */
.invitation-card {
    position: relative;
    width: 100%;
    max-width: 500px; /* 限制寬度像手機或卡片 */
    height: 95vh;     /* 佔滿大部分垂直高度 */
    background: var(--bg-cream);
    border-radius: 15px;
    box-shadow: 0 15px 40px rgba(0,0,0,0.15);
    display: flex;
    flex-direction: column;
    overflow: hidden;
    border: 8px solid white; /* 白邊框 */
    outline: 1px solid #d0d0d0; /* 外細線 */
}

/* === 3. 頂部標題區 === */
.header-section {
    text-align: center;
    padding: 15px 0 5px 0;
    z-index: 10;
}
.header-title {
    font-size: 1.5rem;
    color: var(--theme-green);
    letter-spacing: 3px;
    margin: 0;
    font-weight: normal;
}
.header-subtitle {
    font-size: 0.9rem;
    color: var(--theme-pink);
    letter-spacing: 1px;
    margin-top: 5px;
}

/* === 4. 地圖顯示區 (佔滿中間) === */
.map-viewport {
    flex-grow: 1;
    position: relative;
    overflow: auto;
    display: flex;
    justify-content: center;
    align-items: center;
    /* 隱藏卷軸 */
    scrollbar-width: none; 
}
.map-viewport::-webkit-scrollbar { display: none; }

svg {
    width: 100%;
    height: auto;
    max-width: 100%;
    display: block;
    /* 預設一點點透明，讓背景紋理透出來 */
    opacity: 0.95;
}

/* === 5. 底部搜尋控制區 (整合式) === */
.control-panel {
    position: relative;
    padding: 20px 25px 30px 25px;
    background: white;
    border-top: 1px solid rgba(0,0,0,0.05);
    z-index: 50; /* 確保在最上層 */
    box-shadow: 0 -5px 20px rgba(0,0,0,0.05);
}

.search-container {
    position: relative;
}

/* 搜尋框美化 */
.search-input {
    width: 100%;
    padding: 15px 20px;
    font-size: 16px;
    border: 1px solid #ddd;
    border-radius: 30px;
    background: #fcfcfc;
    outline: none;
    transition: 0.3s;
    box-sizing: border-box;
    text-align: center;
    font-family: "Microsoft JhengHei", sans-serif;
}
.search-input:focus {
    border-color: var(--theme-pink);
    background: white;
    box-shadow: 0 4px 15px rgba(232, 173, 170, 0.2);
}

/* 下拉選單 (搜尋結果) */
.search-results {
    position: absolute;
    bottom: 100%; /* 往上長 */
    left: 0;
    width: 100%;
    max-height: 0; /* 預設隱藏 */
    background: white;
    border-radius: 15px;
    box-shadow: 0 -5px 20px rgba(0,0,0,0.1);
    overflow-y: auto;
    transition: max-height 0.3s ease-out;
    margin-bottom: 10px;
    border: 1px solid #eee;
}
.search-results.open {
    max-height: 250px; /* 展開高度 */
    border-color: var(--theme-pink);
}

.result-item {
    padding: 12px 20px;
    border-bottom: 1px solid #f5f5f5;
    color: #666;
    cursor: pointer;
    transition: 0.2s;
    font-size: 15px;
}
.result-item:hover {
    background-color: var(--theme-pink-light);
    color: var(--theme-green);
}
.result-item:last-child { border-bottom: none; }

/* === 6. 裝飾元素 (葉子 SVG) === */
.decor-leaf {
    position: absolute;
    width: 120px;
    height: 120px;
    pointer-events: none;
    z-index: 5;
    opacity: 0.8;
}
.leaf-top-left { top: 0; left: 0; transform: rotate(0deg); }
.leaf-top-right { top: 0; right: 0; transform: scaleX(-1); }
.leaf-bottom-left { bottom: 80px; left: 0; transform: scaleY(-1); } /* 避開搜尋框 */
.leaf-bottom-right { bottom: 80px; right: 0; transform: scale(-1); }

/* === 7. 地圖元素樣式 === */
.venue-border { fill: none; stroke: #E8E8E8; stroke-width: 2; } /* 淡化邊框 */
.stage-rect { fill: #fff; stroke: var(--theme-green); stroke-width: 1.5; rx: 5; }

.table-circle { fill: white; stroke: #dcdcdc; stroke-width: 2; transition: 0.4s; }
.table-text { fill: #666; font-weight: 900; text-anchor: middle; dominant-baseline: central; pointer-events: none; font-family: "Microsoft JhengHei", sans-serif; }

/* 啟動特效 */
.table-highlight {
    fill: var(--theme-pink-light);
    stroke: var(--theme-pink);
    stroke-width: 4;
    filter: drop-shadow(0 0 8px rgba(232, 173, 170, 0.6));
}
.table-highlight-text { fill: var(--theme-green); }

.path-line {
    fill: none;
    stroke: var(--theme-pink);
    stroke-width: 4;
    stroke-linecap: round;
    stroke-linejoin: round;
    opacity: 0;
    transition: opacity 0.5s;
}
.path-line.visible { opacity: 1; }

.light-dot {
    fill: var(--theme-green); /* 改成綠色光點 */
    stroke: white;
    stroke-width: 2;
    filter: drop-shadow(0 0 4px var(--theme-green));
    opacity: 0;
}

/* Toast */
.notification-toast {
    position: absolute;
    top: 15%; left: 50%;
    transform: translateX(-50%) scale(0.9);
    background: rgba(255, 255, 255, 0.98);
    padding: 12px 30px;
    border-radius: 50px;
    box-shadow: 0 5px 15px rgba(85, 107, 47, 0.15);
    border: 1px solid var(--theme-pink);
    text-align: center;
    opacity: 0;
    visibility: hidden;
    transition: all 0.4s;
    z-index: 100;
    pointer-events: none;
    min-width: 200px;
}
.notification-toast.show {
    opacity: 1;
    visibility: visible;
    transform: translateX(-50%) translateY(10px) scale(1);
}
.toast-name { font-size: 1.4em; color: var(--theme-green); font-weight: bold; display: block; margin-bottom: 4px; }
.toast-table { font-size: 1.1em; color: #666; }

/* Animation */
.target-pulse { transform-origin: center; animation: pulse 2s infinite; }
@keyframes pulse {
    0% { transform: scale(1); opacity: 1; stroke-width: 3; }
    50% { transform: scale(1.1); opacity: 0.7; stroke-width: 5; }
    100% { transform: scale(1); opacity: 1; stroke-width: 3; }
}

</style>
</head>
<body>

<div class="invitation-card">
    
    <svg class="decor-leaf leaf-top-left" viewBox="0 0 100 100">
        <path d="M0,0 Q40,10 50,50 T80,90 M10,10 L20,15 M20,25 L30,30 M30,40 L40,45" stroke="#556B2F" stroke-width="2" fill="none" opacity="0.3"/>
        <circle cx="50" cy="50" r="2" fill="#E8ADAA" opacity="0.6"/>
        <circle cx="70" cy="30" r="3" fill="#E8ADAA" opacity="0.5"/>
    </svg>
    <svg class="decor-leaf leaf-top-right" viewBox="0 0 100 100">
        <path d="M0,0 Q40,10 50,50 T80,90" stroke="#556B2F" stroke-width="2" fill="none" opacity="0.3"/>
    </svg>
    <svg class="decor-leaf leaf-bottom-left" viewBox="0 0 100 100" style="width:100px; height:100px;">
        <path d="M0,0 Q40,10 50,50 T80,90" stroke="#556B2F" stroke-width="2" fill="none" opacity="0.3"/>
    </svg>
    <svg class="decor-leaf leaf-bottom-right" viewBox="0 0 100 100" style="width:100px; height:100px;">
        <path d="M0,0 Q40,10 50,50 T80,90" stroke="#556B2F" stroke-width="2" fill="none" opacity="0.3"/>
    </svg>

    <div class="header-section">
        <h1 class="header-title">WEDDING SEATING</h1>
        <div class="header-subtitle">Welcome to Our Celebration</div>
    </div>

    <div class="map-viewport" id="mapWrapper">
        <div class="notification-toast" id="toast">
            <span class="toast-name" id="toastName"></span>
            <span class="toast-table" id="toastTable"></span>
        </div>

        <svg viewBox="0 0 800 1150" id="venueMap">
            <defs>
                <filter id="paper">
                    <feTurbulence type="fractalNoise" baseFrequency="0.04" numOctaves="5" result="noise"/>
                    <feDiffuseLighting in="noise" lighting-color="#fff" surfaceScale="2">
                        <feDistantLight azimuth="45" elevation="60"/>
                    </feDiffuseLighting>
                </filter>
            </defs>

            <rect x="0" y="0" width="800" height="1150" fill="#fffcf5" filter="url(#paper)" opacity="0.5"/>

            <rect x="20" y="20" width="760" height="1110" class="venue-border" rx="20" />
            
            <rect x="250" y="50" width="300" height="60" class="stage-rect" />
            <text x="400" y="90" font-size="24" fill="#556B2F" text-anchor="middle" letter-spacing="4" font-family="serif">STAGE</text>
            
            <g id="tablesLayer"></g>
            <path id="guidePath" class="path-line" d="" />
            
            <circle id="movingDot" r="10" class="light-dot">
                <animateMotion id="dotAnim" dur="2.5s" begin="indefinite" fill="freeze" calcMode="spline" keyTimes="0;1" keySplines="0.42 0 0.58 1">
                    <mpath href="#guidePath" />
                </animateMotion>
                <animate attributeName="opacity" values="0;1;1;0" keyTimes="0;0.1;0.9;1" dur="2.5s" begin="dotAnim.begin" fill="freeze" />
            </circle>
        </svg>
    </div>

    <div class="control-panel">
        <div class="search-container">
            <div class="search-results" id="searchResults">
                </div>
            
            <input type="text" class="search-input" id="searchInput" 
                   placeholder="請輸入姓名查詢座位..." 
                   oninput="handleSearch()" 
                   onclick="handleSearch()"
                   autocomplete="off">
        </div>
    </div>
</div>

<script>
// === 1. 賓客資料 (完整保留) ===
const guestDataRaw = [
    { table: "主桌", names: ["曾宗敏 舅舅", "潘亮如 舅媽", "曾美珠 大姨", "呂武南", "曾蕉治", "林添裕", "陳姿靚", "林森 爺爺", "黃桃 奶奶", "呂尚恩", "林怡姿", "豪美姑姑"] },
    { table: "大姑姑闔家", names: ["林德城 大姑丈闔家"] },
    { table: "小吱爸朋友", names: ["水電郭", "詹老師", "茂森", "張醫師", "邱源志"] }, 
    { table: "小吱媽朋友", names: ["大舅媽", "四舊媽", "小鳳阿姨"] }, 
    { table: "小吱大學同學", names: ["曾莉晴", "周靖婷", "蔡宜汝", "林建廷", "李欣育", "黃士剛", "劉又瑄"] }, 
    { table: "小吱高中同學", names: ["淑靜", "貴婦文琪", "黃郁倫", "李兆家", "林巧涵", "蘇慧娟"] }, 
    { table: "小吱同期_1", names: ["陳安信", "莊維澤", "程慧晶", "孫瑋彤+陳書郁", "瑞成", "李昕諭（虎克）", "林家伃"] }, 
    { table: "小吱同期_2", names: ["陳麒", "鄭宇", "黃靖崴", "胡家瑋", "洪韻筑", "翁瑄禮", "江怡萱", "葉芮羽"] }, 
    { table: "小吱同期_3", names: ["陳一誠", "翁嘉隆", "羅文鴻", "尤彥傑", "羅佾德", "陳金鴻"] }, 
    { table: "小吱同事_1", names: ["張嘉芳", "戴筌宇", "陳芷萱", "蔣文萱", "鄭宇鈜", "吳俞玲", "林英奇", "胡慧滿"] }, 
    { table: "小吱同事_2", names: ["林芳如", "白惠淑", "吳珈禎"] }, 
    { table: "長庚家福_1", names: ["蕉治親友 長庚家福"] },
    { table: "長庚家福_2", names: ["蕉治親友 長庚家福"] },
    { table: "曾氏宗親會_1", names: ["曾宗敏 舅舅闔家", "郭火木 大姨丈闔家", "呂國舜 姨丈闔家", "呂宜庭"] },
    { table: "二位姑姑家", names: ["呂惠珍 二姑姑闔家", , "陳惠娟 小姑姑闔家"] },
    { table: "曾氏宗親會_2", names: ["莊有義 二姨丈闔家"] },
    { table: "河東獅長官", names: ["陳麗琇 主任闔家", "李育信 庭長闔家", "李宛凌 主任", "呂建興 主任", "林志祐 襄閱", "謝長夏 主任", "黃昭翰 學長闔家", "董秀菁 主任"] },
    { table: "瘋狂四一六", names: ["黃嬿如 學姊", "李侑姿 主任闔家", "宋文宏 襄閱闔家", "張志宏 帥哥", "張良鏡 帥哥", "陳彥丞 帥哥", "邱宥鈞 帥哥"] },
    { table: "不正經學長", names: ["王建中 學長", "范家振 學長", "蔡杰承 主任闔家", "蘇恒毅 主任闔家", "陳永盛 學長", "張雅婷 學姊"] },
    { table: "六＿十＿期", names: ["邱蓓真 媽咪", "陳郁雯 太太", "戴旻諺 總長", "詹皇輝 大律師", "黃虹蓁 青梅竹馬", "顏鸝靚 大美女", "侯慶忠 帥哥闔家", "蔡旻諺 學長闔家"] },
    { table: "六十期唉組", names: ["王雪君 太太", "陳䊹伊 越南王", "曾亭瑋 波波媽咪", "李佩宣 美女 ", "吳昭億 胖子", "許家菱 捧花得主", "蔡明峰 帥哥"] },
    { table: "法務部長官", names: ["劉慕珊 主任", "姚崇略 長官", "余彬誠 主任", "劉建志 主任", "許萃華 學姊", "甘若蘋 主任", "黃元冠 檢察長", "楊碧瑛 分署長","朱家崎 檢察長", "高碧霞 老師"] },
    { table: "法律一〇五", names: ["劉誠夫 律師", "鍾守軒 設計師", "魏禮 巨巨", "劉俊强 歐爸", "劉育杰 老闆", "謝佳君 媽咪", "蔣瑞安 律師", "廖強志 律師"] },
    { table: "歡樂三一〇", names: ["高翊銘 長官", "魏今芸 媽咪", "游慧玟 媽咪", "黃泓儒 帥哥", "黃品叡 帥哥", "邱柏彰 帥哥", "劉虹汝 老師"] },
    { table: "刑事比人強", names: ["徐崇育", "蘇詠群", "鄭羽成", "黃健銘", "朱子賢"] },
    { table: "26", names: ["小吱爸親戚(備用)"] },
    { table: "27", names: ["親友27"] }
];

let guestData = [];
guestDataRaw.forEach(group => {
    group.names.forEach(name => {
        guestData.push({ name: name, table: group.table });
    });
});
guestData.sort((a, b) => a.name.localeCompare(b.name, "zh-TW"));

// === 2. 桌次座標 ===
const tableCoords = {
    "二位姑姑家": {x: 190, y: 250}, "曾氏宗親會_1": {x: 190, y: 380}, "河東獅長官": {x: 190, y: 510}, "不正經學長": {x: 190, y: 640}, "歡樂三一〇": {x: 190, y: 770}, "刑事比人強": {x: 190, y: 900}, "曾氏宗親會_2": {x: 80, y: 300},
    "主桌": {x: 400, y: 200}, "大姑姑闔家": {x: 300, y: 300}, "法務部長官": {x: 300, y: 430}, "瘋狂四一六": {x: 300, y: 560}, "六＿十＿期": {x: 300, y: 690}, "六十期唉組": {x: 300, y: 820}, "法律一〇五": {x: 300, y: 950},
    "小吱爸親戚_1": {x: 500, y: 300}, "野貓團": {x: 500, y: 430}, "59期": {x: 500, y: 560}, "A組同學": {x: 500, y: 690}, "高中同學": {x: 500, y: 820}, "大學同學": {x: 500, y: 950},
    "小吱媽朋友": {x: 610, y: 250}, "小吱爸朋友": {x: 610, y: 380}, "法院老同事": {x: 610, y: 510}, "中院同事": {x: 610, y: 640}, "大寶媽朋友_1": {x: 610, y: 770}, "大寶媽朋友_2": {x: 610, y: 900},
    "小吱爸親戚_2": {x: 720, y: 300}
};

// === 3. 初始化 ===
const tablesLayer = document.getElementById('tablesLayer');
const resultsDiv = document.getElementById('searchResults');
const guidePath = document.getElementById('guidePath');
const dotAnim = document.getElementById('dotAnim');
const toast = document.getElementById('toast');
const toastName = document.getElementById('toastName');
const toastTable = document.getElementById('toastTable');
const searchInput = document.getElementById('searchInput');

// 繪製桌子
function drawTables() {
    for (const [id, pos] of Object.entries(tableCoords)) {
        const g = document.createElementNS("http://www.w3.org/2000/svg", "g");
        let radius = 44; 
        let fontSize = 22; 

        if (id === "主桌") { radius = 70; fontSize = 32; } 
        else {
            if (id.length > 5) fontSize = 18;
            else if (id.length > 4) fontSize = 20;
            else fontSize = 22;
        }
        
        const circle = document.createElementNS("http://www.w3.org/2000/svg", "circle");
        circle.setAttribute("cx", pos.x); circle.setAttribute("cy", pos.y);
        circle.setAttribute("r", radius); circle.setAttribute("class", "table-circle");
        circle.setAttribute("id", "t-" + id);

        const text = document.createElementNS("http://www.w3.org/2000/svg", "text");
        text.setAttribute("x", pos.x); text.setAttribute("y", pos.y);
        text.setAttribute("class", "table-text"); text.setAttribute("id", "txt-" + id);
        text.setAttribute("font-size", fontSize);
        text.textContent = id;

        g.appendChild(circle); g.appendChild(text);
        tablesLayer.appendChild(g);
    }
}

// 處理搜尋 (下拉選單邏輯)
function handleSearch() {
    const filter = searchInput.value;
    resultsDiv.innerHTML = "";
    
    if (filter === "") {
        // 如果沒輸入，可以選擇隱藏，或顯示「請輸入姓名」
        // 這裡設定為：若點擊輸入框但沒文字，顯示所有名單(或前20個)
        // 為了效能，這裡只顯示符合的前 10 筆，或者全部
    }
    
    let count = 0;
    let seen = new Set();

    guestData.forEach(g => {
        if (g.name.includes(filter) && !seen.has(g.name + g.table)) {
            seen.add(g.name + g.table);
            
            const item = document.createElement("div");
            item.className = "result-item";
            item.innerText = g.name;
            item.onclick = () => selectGuest(g.name, g.table);
            resultsDiv.appendChild(item);
            count++;
        }
    });

    if (count > 0) {
        resultsDiv.classList.add('open');
    } else {
        resultsDiv.classList.remove('open');
    }
}

// 點擊外部關閉選單
document.addEventListener('click', function(e) {
    if (!document.querySelector('.search-container').contains(e.target)) {
        resultsDiv.classList.remove('open');
    }
});

// 選擇賓客
function selectGuest(name, tableId) {
    const target = tableCoords[tableId];
    if (!target) return;

    // 1. 更新 UI
    searchInput.value = name; // 將名字填入搜尋框
    resultsDiv.classList.remove('open'); // 關閉選單
    
    // 2. 重置地圖
    document.querySelectorAll('.table-circle').forEach(c => c.classList.remove('table-highlight', 'target-pulse'));
    document.querySelectorAll('.table-text').forEach(t => t.classList.remove('table-highlight-text'));
    toast.classList.remove('show');

    // 3. 顯示 Toast
    toastName.innerText = name;
    toastTable.innerText = `請入席 ${tableId}`;
    toast.classList.add('show');
    setTimeout(() => toast.classList.remove('show'), 4000);

    // 4. 動畫
    const startX = 400; const startY = 1130;
    const cp1y = startY - 150;
    const pathD = `M ${startX} ${startY} L ${startX} ${startY-50} C ${startX} ${cp1y}, ${startX} ${target.y}, ${target.x} ${target.y}`;
    
    guidePath.setAttribute("d", pathD);
    guidePath.classList.add("visible");

    const dot = document.getElementById('movingDot');
    dot.style.display = 'none';
    void dot.offsetWidth;
    dot.style.display = 'block';
    dotAnim.beginElement();

    setTimeout(() => {
        const tCircle = document.getElementById("t-" + tableId);
        const tText = document.getElementById("txt-" + tableId);
        if(tCircle) {
            tCircle.classList.add('table-highlight', 'target-pulse');
            tText.classList.add('table-highlight-text');
        }
    }, 2500);
}

drawTables();
</script>
</body>
</html>
